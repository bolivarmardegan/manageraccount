<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">
<body>
<h:form id="formFin">
	<p:messages id="mess"></p:messages>
	<p:fieldset style="width:150%;" id="fieldFin">
				<p:panelGrid columns="3"  id="tabCadastroCal">
				<p:column>
					<p:panelGrid columns="2" id="tabCate">
						<p:column>
							<p:outputLabel value="Grupo da Finança" />
						</p:column>
						<p:column>
							<p:selectOneMenu rendered="#{financasMBean.opcao == ('selecionar')}"
								value="#{financasMBean.categoria.id}">
								<f:selectItem itemLabel="Grupo" />
								<f:selectItems
									value="#{financasMBean.categoriaList}"
									var="cate" itemLabel="#{cate.nome}"
									itemValue="#{cate.id}" />
									<p:ajax listener="#{financasMBean.carregarFinancasPorCategoriaInclude()}" event="change" 
										update="formFin:panelFin, formFin:panelBtn"/>
							</p:selectOneMenu>
							<p:inputText rendered="#{financasMBean.opcao == ('digitar')}" value="#{financasMBean.categoria.nome}"/>
						</p:column>
						<p:column>
							<p:selectOneRadio id="opcao" value="#{financasMBean.opcao}">
					            <f:selectItem  itemLabel="Nova " itemValue="digitar"/>
					            <f:selectItem  itemLabel="Selecionar" itemValue="selecionar" />
					            <p:ajax listener="#{financasMBean.limpar()}" update="tabCate, formFin:panelBtn, formFin:panelFin" event="click"/>
					        </p:selectOneRadio>
						</p:column>
					</p:panelGrid>
				</p:column>
				<p:column>
						<p:fieldset id="tabDados" style="width:100%;">
							<p:panelGrid columns="4">
								<p:column>
									<p:outputLabel value="Nome"/>
								</p:column>
								<p:column>
									<p:inputText value="#{financasMBean.financa.nome}"/>
								</p:column>
								<p:column>
									<p:outputLabel value="Tipo"/>
								</p:column>
								<p:column>
									<p:selectOneMenu
										value="#{financasMBean.financa.tipoFinanca}">
										<f:selectItem itemLabel="Tipo da Finança" />
										<f:selectItems
											value="#{financasMBean.tipoFinancaList}"
											var="tipo" itemLabel="#{tipo.nome}"
											itemValue="#{tipo.nome}" />
									</p:selectOneMenu>
								</p:column>
									<p:column>
									<p:outputLabel value="Vencimento"/>
								</p:column>
								<p:column>
									<p:calendar pattern="dd/MM/yyyy" mindate="#{financasMBean.dataMinima.time}" maxdate="#{financasMBean.dataMaxima.time}"
										value="#{financasMBean.financa.dataVencimento}" 
										converter="dateConverter" locale="pt">
									</p:calendar>
									<p:dialog modal="true" resizable="false" header="Values"  showEffect="fold">
								        <p:panelGrid id="display" >
								            <h:outputText  value="#{financasMBean.financa.dataVencimento}">
								            	<f:convertDateTime pattern="dd/MM/yyyy" />
								            </h:outputText>
										</p:panelGrid>
										</p:dialog>
									</p:column>
								<p:column>
									<p:outputLabel value="R$"/>
								</p:column>
								<p:column>
									<p:inputNumber symbol="R$" maxValue="999999999999"  value="#{financasMBean.financa.valor}"/>
								</p:column>
							
								<p:column id="panelBtn">
										<p:commandButton  icon="ui-icon-cancel"  title="Cancelar">
												<p:ajax listener="#{financasMBean.limpar()}"
												update="formFin:tabDados, formFin:panelFin, formFin:panelBtn, formFin:tabCadastroCal" event="click"/>
										</p:commandButton>
										<p:commandButton title="Salvar"
											icon="ui-icon-plus"
											action="#{financasMBean.salvar()}"
											update="form,formFin:mess, formFin:tabDados, formFin:panelFin, formFin:tabFinancas" />
								</p:column>
							</p:panelGrid>							
						</p:fieldset>
						<br />
					</p:column>
		</p:panelGrid>
		<p:fieldset id="panelFin" legend="Finanças" >
					<p:dataTable id="tabFinancas" value="#{financasMBean.financas}" var="financa" rows="5" style="width:100%;" paginator="true" 
						paginatorPosition="bottom">
								<p:column headerText="Nome" style="width:46%;">
									<p:outputLabel value="#{financa.nome}"/>
								</p:column>
								<p:column headerText="Vencimento" style="width:12%;">
									<p:outputLabel 	value="#{financa.dataVencimento}" 	 disabled="true">
													<f:converter converterId="dateConverter"/>
												</p:outputLabel>
								</p:column>
								<p:column headerText="Valor" style="width:15%;">
									<p:outputLabel value="#{financa.valor}"/>
								</p:column>
								<p:column headerText="Tipo" style="width:15%;">
									<p:outputLabel value="#{financa.tipoFinanca}"/>
								</p:column>
								
					</p:dataTable>
		</p:fieldset>
		
	</p:fieldset>
	
	
	</h:form>
</body>
</html>

